# Common problems

## Unable to load native-hadoop library for your platform

When your run any hadoop related commands, you will receive the below warning.

```text
Unable to load native-hadoop library for your platform... Using builtin-java classes where applicable
```

This warning is caused by `hadoop` can't find the native-hadoop library path in your execution environment.

You can specify the path with the below commands

```shell
export HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native
export HADOOP_OPTS="$HADOOP_OPTS -Djava.library.path=$HADOOP_HOME/lib/native"
export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$HADOOP_HOME/lib/native
```

If you want to persiste this fix, you can put these three lines in `/etc/profil.d/hadoop.sh` or 
`$HADOOP_HOME/etc/hadoop/hadoop-env.sh`.

## You have loaded library /.../hadoop-3.3.6/lib/native/libhadoop.so which might have disabled stack guard.

When your run any hadoop related commands, you will receive the below warning.

```text
You have loaded library /.../hadoop-3.3.6/lib/native/libhadoop.so which might have disabled stack guard. 
The vm will try to fix the stack guard now.

it's hight recommanded that you fix the library with execstack -c <libfile> or link it with -z noexecstack
```

This warning is caused by the lost symbolic link between `libhadoop.so -> libhadoop.so.1.0.0`. The `libhadoop.so`
is only a link to the real `libhadoop.so.1.0.0`. When you zip the hadoop binary with tools like zip under Windows.
The symbolic link is broken.

To fix it, you need to

```shell
cd $HADOOP_HOME/lib/native

# check the lib file
ls -lah | grep -i "libhadoop"

# if you see the libhadoop.so file has 0 byte as file size and no link to  libhadoop.so.1.0.0.
# you need to remove it and create a new one
rm libhadoop.so

ln -s libhadoop.so.1.0.0 libhadoop.so
```